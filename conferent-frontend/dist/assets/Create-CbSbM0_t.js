import{_ as T,U as y,a as C,r as k}from"./index-DLxo1fU2.js";import{B as R}from"./BaseButton-DyjRtvra.js";import{j as I,w as f,r as c,o as l,b as o,a as p,f as h,l as w,c as m,g as u,d as a,F as D,k as x,t as n,u as B,v as d}from"./vendor-CfKmPEc8.js";import"./utils-Dq7h7Pqt.js";const U={name:"ReservationCreate",components:{UserLayout:y,BaseButton:R},data(){return{loading:!1,rooms:[],selectedRoom:null,timeConflict:!1,form:{roomId:"",date:"",startTime:"",endTime:"",purpose:"",attendees:"",description:""}}},computed:{minDate(){return new Date().toISOString().split("T")[0]}},mounted(){this.loadRooms(),this.initializeForm()},methods:{async loadRooms(){try{const r=await k.getAllRooms();this.rooms=r.data}catch(r){console.error("Failed to load rooms:",r)}},initializeForm(){const r=this.$route.query.roomId;r&&(this.form.roomId=r,this.handleRoomChange()),this.form.date=this.minDate},handleRoomChange(){this.selectedRoom=this.rooms.find(r=>r.id==this.form.roomId),this.checkTimeConflict()},handleDateChange(){this.checkTimeConflict()},handleTimeChange(){this.checkTimeConflict()},async checkTimeConflict(){if(!this.form.roomId||!this.form.date||!this.form.startTime||!this.form.endTime){this.timeConflict=!1;return}try{const r=await C.checkConflict({roomId:this.form.roomId,date:this.form.date,startTime:this.form.startTime,endTime:this.form.endTime});this.timeConflict=r.data.hasConflict}catch(r){console.error("Failed to check time conflict:",r)}},async handleSubmit(){this.loading=!0;try{const r={...this.form,startDateTime:`${this.form.date}T${this.form.startTime}`,endDateTime:`${this.form.date}T${this.form.endTime}`};await C.createRent(r),this.$router.push("/reservations")}catch(r){alert("예약 생성에 실패했습니다."),console.error("Failed to create reservation:",r)}finally{this.loading=!1}},handleCancel(){this.$router.push("/reservations")}}},V={class:"reservation-create"},S={class:"reservation-create__header"},F={class:"reservation-create__breadcrumb"},q={class:"reservation-create__form"},L={class:"form-row"},N={class:"form-group"},A=["value"],M={class:"form-group"},z=["min"],j={class:"form-row"},E={class:"form-group"},O={class:"form-group"},G={class:"form-group"},H={class:"form-group"},J=["max"],K={key:0,class:"form-help"},P={class:"form-group"},Q={key:0,class:"form-warning"},W={key:1,class:"selected-room-info"},X={class:"selected-room-info__content"},Y={class:"room-info-item"},Z={class:"room-info-value"},$={class:"room-info-item"},ee={class:"room-info-value"},oe={class:"room-info-item"},te={class:"room-info-value"},se={key:0,class:"room-info-item"},re={class:"room-info-value"},ie={class:"form-actions"};function ne(r,e,le,ae,s,i){const _=c("router-link"),v=c("BaseButton"),g=c("UserLayout");return l(),I(g,null,{default:f(()=>{var b;return[o("div",V,[o("div",S,[o("div",F,[p(_,{to:"/reservations",class:"breadcrumb-link"},{default:f(()=>e[12]||(e[12]=[h("내 예약")])),_:1,__:[12]}),e[13]||(e[13]=o("span",{class:"breadcrumb-separator"},">",-1)),e[14]||(e[14]=o("span",{class:"breadcrumb-current"},"새 예약",-1))]),e[15]||(e[15]=o("h1",{class:"reservation-create__title"},"회의실 예약",-1))]),o("div",q,[o("form",{onSubmit:e[11]||(e[11]=w((...t)=>i.handleSubmit&&i.handleSubmit(...t),["prevent"]))},[o("div",L,[o("div",N,[e[17]||(e[17]=o("label",{for:"roomId",class:"form-label"},"회의실 *",-1)),a(o("select",{id:"roomId","onUpdate:modelValue":e[0]||(e[0]=t=>s.form.roomId=t),class:"form-select",required:"",onChange:e[1]||(e[1]=(...t)=>i.handleRoomChange&&i.handleRoomChange(...t))},[e[16]||(e[16]=o("option",{value:""},"회의실을 선택하세요",-1)),(l(!0),m(D,null,x(s.rooms,t=>(l(),m("option",{key:t.id,value:t.id},n(t.name)+" ("+n(t.location)+", 최대 "+n(t.capacity)+"명) ",9,A))),128))],544),[[B,s.form.roomId]])]),o("div",M,[e[18]||(e[18]=o("label",{for:"date",class:"form-label"},"날짜 *",-1)),a(o("input",{id:"date","onUpdate:modelValue":e[2]||(e[2]=t=>s.form.date=t),type:"date",class:"form-input",required:"",min:i.minDate,onChange:e[3]||(e[3]=(...t)=>i.handleDateChange&&i.handleDateChange(...t))},null,40,z),[[d,s.form.date]])])]),o("div",j,[o("div",E,[e[19]||(e[19]=o("label",{for:"startTime",class:"form-label"},"시작 시간 *",-1)),a(o("input",{id:"startTime","onUpdate:modelValue":e[4]||(e[4]=t=>s.form.startTime=t),type:"time",class:"form-input",required:"",onChange:e[5]||(e[5]=(...t)=>i.handleTimeChange&&i.handleTimeChange(...t))},null,544),[[d,s.form.startTime]])]),o("div",O,[e[20]||(e[20]=o("label",{for:"endTime",class:"form-label"},"종료 시간 *",-1)),a(o("input",{id:"endTime","onUpdate:modelValue":e[6]||(e[6]=t=>s.form.endTime=t),type:"time",class:"form-input",required:"",onChange:e[7]||(e[7]=(...t)=>i.handleTimeChange&&i.handleTimeChange(...t))},null,544),[[d,s.form.endTime]])])]),o("div",G,[e[21]||(e[21]=o("label",{for:"purpose",class:"form-label"},"회의 목적 *",-1)),a(o("input",{id:"purpose","onUpdate:modelValue":e[8]||(e[8]=t=>s.form.purpose=t),type:"text",class:"form-input",required:"",placeholder:"회의 목적을 입력하세요"},null,512),[[d,s.form.purpose]])]),o("div",H,[e[22]||(e[22]=o("label",{for:"attendees",class:"form-label"},"참석 인원",-1)),a(o("input",{id:"attendees","onUpdate:modelValue":e[9]||(e[9]=t=>s.form.attendees=t),type:"number",class:"form-input",min:"1",max:((b=s.selectedRoom)==null?void 0:b.capacity)||50,placeholder:"참석 예정 인원수"},null,8,J),[[d,s.form.attendees,void 0,{number:!0}]]),s.selectedRoom?(l(),m("div",K," 최대 "+n(s.selectedRoom.capacity)+"명까지 가능합니다. ",1)):u("",!0)]),o("div",P,[e[23]||(e[23]=o("label",{for:"description",class:"form-label"},"상세 내용",-1)),a(o("textarea",{id:"description","onUpdate:modelValue":e[10]||(e[10]=t=>s.form.description=t),class:"form-textarea",rows:"4",placeholder:"회의에 대한 추가 정보를 입력하세요"},null,512),[[d,s.form.description]])]),s.timeConflict?(l(),m("div",Q," ⚠️ 선택한 시간에 다른 예약이 있습니다. 다른 시간을 선택해주세요. ")):u("",!0),s.selectedRoom?(l(),m("div",W,[e[28]||(e[28]=o("h3",{class:"selected-room-info__title"},"선택된 회의실",-1)),o("div",X,[o("div",Y,[e[24]||(e[24]=o("span",{class:"room-info-label"},"이름:",-1)),o("span",Z,n(s.selectedRoom.name),1)]),o("div",$,[e[25]||(e[25]=o("span",{class:"room-info-label"},"위치:",-1)),o("span",ee,n(s.selectedRoom.location),1)]),o("div",oe,[e[26]||(e[26]=o("span",{class:"room-info-label"},"수용인원:",-1)),o("span",te,"최대 "+n(s.selectedRoom.capacity)+"명",1)]),s.selectedRoom.description?(l(),m("div",se,[e[27]||(e[27]=o("span",{class:"room-info-label"},"설명:",-1)),o("span",re,n(s.selectedRoom.description),1)])):u("",!0)])])):u("",!0),o("div",ie,[p(v,{type:"button",variant:"secondary",onClick:i.handleCancel},{default:f(()=>e[29]||(e[29]=[h(" 취소 ")])),_:1,__:[29]},8,["onClick"]),p(v,{type:"submit",variant:"primary",disabled:s.loading||s.timeConflict},{default:f(()=>[h(n(s.loading?"예약 중...":"예약하기"),1)]),_:1},8,["disabled"])])],32)])])]}),_:1})}const ce=T(U,[["render",ne],["__scopeId","data-v-b110c844"]]);export{ce as default};
//# sourceMappingURL=Create-CbSbM0_t.js.map
